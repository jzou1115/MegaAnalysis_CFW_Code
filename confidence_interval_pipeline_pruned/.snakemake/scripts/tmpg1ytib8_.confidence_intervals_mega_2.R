
######## Snakemake header ########
library(methods)
Snakemake <- setClass(
    "Snakemake",
    slots = c(
        input = "list",
        output = "list",
        params = "list",
        wildcards = "list",
        threads = "numeric",
        log = "list",
        resources = "list",
        config = "list",
        rule = "character",
        bench_iteration = "numeric",
        scriptdir = "character",
        source = "function"
    )
)
snakemake <- Snakemake(
    input = list('/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/data/qtls/qtls_decorrelated_threshold2.txt', '/u/home/j/jzou1115/project-zarlab/CFW/MegaAnalysis_CFW_2019/genotypes/oxinfo90/chr1.oxinfo90.Rdata', '/u/home/j/jzou1115/project-zarlab/CFW/MegaAnalysis_CFW_2019/genotypes/oxinfo90/chr2.oxinfo90.Rdata', '/u/home/j/jzou1115/project-zarlab/CFW/MegaAnalysis_CFW_2019/genotypes/oxinfo90/chr3.oxinfo90.Rdata', '/u/home/j/jzou1115/project-zarlab/CFW/MegaAnalysis_CFW_2019/genotypes/oxinfo90/chr4.oxinfo90.Rdata', '/u/home/j/jzou1115/project-zarlab/CFW/MegaAnalysis_CFW_2019/genotypes/oxinfo90/chr5.oxinfo90.Rdata', '/u/home/j/jzou1115/project-zarlab/CFW/MegaAnalysis_CFW_2019/genotypes/oxinfo90/chr6.oxinfo90.Rdata', '/u/home/j/jzou1115/project-zarlab/CFW/MegaAnalysis_CFW_2019/genotypes/oxinfo90/chr7.oxinfo90.Rdata', '/u/home/j/jzou1115/project-zarlab/CFW/MegaAnalysis_CFW_2019/genotypes/oxinfo90/chr8.oxinfo90.Rdata', '/u/home/j/jzou1115/project-zarlab/CFW/MegaAnalysis_CFW_2019/genotypes/oxinfo90/chr9.oxinfo90.Rdata', '/u/home/j/jzou1115/project-zarlab/CFW/MegaAnalysis_CFW_2019/genotypes/oxinfo90/chr10.oxinfo90.Rdata', '/u/home/j/jzou1115/project-zarlab/CFW/MegaAnalysis_CFW_2019/genotypes/oxinfo90/chr11.oxinfo90.Rdata', '/u/home/j/jzou1115/project-zarlab/CFW/MegaAnalysis_CFW_2019/genotypes/oxinfo90/chr12.oxinfo90.Rdata', '/u/home/j/jzou1115/project-zarlab/CFW/MegaAnalysis_CFW_2019/genotypes/oxinfo90/chr13.oxinfo90.Rdata', '/u/home/j/jzou1115/project-zarlab/CFW/MegaAnalysis_CFW_2019/genotypes/oxinfo90/chr14.oxinfo90.Rdata', '/u/home/j/jzou1115/project-zarlab/CFW/MegaAnalysis_CFW_2019/genotypes/oxinfo90/chr15.oxinfo90.Rdata', '/u/home/j/jzou1115/project-zarlab/CFW/MegaAnalysis_CFW_2019/genotypes/oxinfo90/chr16.oxinfo90.Rdata', '/u/home/j/jzou1115/project-zarlab/CFW/MegaAnalysis_CFW_2019/genotypes/oxinfo90/chr17.oxinfo90.Rdata', '/u/home/j/jzou1115/project-zarlab/CFW/MegaAnalysis_CFW_2019/genotypes/oxinfo90/chr18.oxinfo90.Rdata', '/u/home/j/jzou1115/project-zarlab/CFW/MegaAnalysis_CFW_2019/genotypes/oxinfo90/chr19.oxinfo90.Rdata', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.activity30.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.activity5.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.activity.begin.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.activity.end.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.activity.middle.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.activity.total.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.basal.activity.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.bmd.a.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.bmd.n.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.bmd.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.decay.activity.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.EDL.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.fc.baseline.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.fc.context.corr.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.fc.context.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.fc.cue.baseline.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.fc.cue.corr.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.fc.cue.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.fc.uncond.freeze.corr.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.fc.uncond.freeze.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.gastroc.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.glucose.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.habit.diff.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.habit.ratio.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.plantaris.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.pp12.ppi.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.pp6.ppi.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.soleus.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.startle.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.tail.length.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.TA.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.tibia.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.weight.bmi.tibia.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.weight.RData', "qtls" = '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/data/qtls/qtls_decorrelated_threshold2.txt', "genoFiles" = c('/u/home/j/jzou1115/project-zarlab/CFW/MegaAnalysis_CFW_2019/genotypes/oxinfo90/chr1.oxinfo90.Rdata', '/u/home/j/jzou1115/project-zarlab/CFW/MegaAnalysis_CFW_2019/genotypes/oxinfo90/chr2.oxinfo90.Rdata', '/u/home/j/jzou1115/project-zarlab/CFW/MegaAnalysis_CFW_2019/genotypes/oxinfo90/chr3.oxinfo90.Rdata', '/u/home/j/jzou1115/project-zarlab/CFW/MegaAnalysis_CFW_2019/genotypes/oxinfo90/chr4.oxinfo90.Rdata', '/u/home/j/jzou1115/project-zarlab/CFW/MegaAnalysis_CFW_2019/genotypes/oxinfo90/chr5.oxinfo90.Rdata', '/u/home/j/jzou1115/project-zarlab/CFW/MegaAnalysis_CFW_2019/genotypes/oxinfo90/chr6.oxinfo90.Rdata', '/u/home/j/jzou1115/project-zarlab/CFW/MegaAnalysis_CFW_2019/genotypes/oxinfo90/chr7.oxinfo90.Rdata', '/u/home/j/jzou1115/project-zarlab/CFW/MegaAnalysis_CFW_2019/genotypes/oxinfo90/chr8.oxinfo90.Rdata', '/u/home/j/jzou1115/project-zarlab/CFW/MegaAnalysis_CFW_2019/genotypes/oxinfo90/chr9.oxinfo90.Rdata', '/u/home/j/jzou1115/project-zarlab/CFW/MegaAnalysis_CFW_2019/genotypes/oxinfo90/chr10.oxinfo90.Rdata', '/u/home/j/jzou1115/project-zarlab/CFW/MegaAnalysis_CFW_2019/genotypes/oxinfo90/chr11.oxinfo90.Rdata', '/u/home/j/jzou1115/project-zarlab/CFW/MegaAnalysis_CFW_2019/genotypes/oxinfo90/chr12.oxinfo90.Rdata', '/u/home/j/jzou1115/project-zarlab/CFW/MegaAnalysis_CFW_2019/genotypes/oxinfo90/chr13.oxinfo90.Rdata', '/u/home/j/jzou1115/project-zarlab/CFW/MegaAnalysis_CFW_2019/genotypes/oxinfo90/chr14.oxinfo90.Rdata', '/u/home/j/jzou1115/project-zarlab/CFW/MegaAnalysis_CFW_2019/genotypes/oxinfo90/chr15.oxinfo90.Rdata', '/u/home/j/jzou1115/project-zarlab/CFW/MegaAnalysis_CFW_2019/genotypes/oxinfo90/chr16.oxinfo90.Rdata', '/u/home/j/jzou1115/project-zarlab/CFW/MegaAnalysis_CFW_2019/genotypes/oxinfo90/chr17.oxinfo90.Rdata', '/u/home/j/jzou1115/project-zarlab/CFW/MegaAnalysis_CFW_2019/genotypes/oxinfo90/chr18.oxinfo90.Rdata', '/u/home/j/jzou1115/project-zarlab/CFW/MegaAnalysis_CFW_2019/genotypes/oxinfo90/chr19.oxinfo90.Rdata'), "mmFiles" = c('/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.activity30.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.activity5.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.activity.begin.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.activity.end.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.activity.middle.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.activity.total.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.basal.activity.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.bmd.a.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.bmd.n.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.bmd.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.decay.activity.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.EDL.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.fc.baseline.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.fc.context.corr.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.fc.context.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.fc.cue.baseline.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.fc.cue.corr.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.fc.cue.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.fc.uncond.freeze.corr.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.fc.uncond.freeze.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.gastroc.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.glucose.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.habit.diff.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.habit.ratio.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.plantaris.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.pp12.ppi.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.pp6.ppi.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.soleus.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.startle.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.tail.length.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.TA.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.tibia.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.weight.bmi.tibia.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/emma.weight.RData')),
    output = list('/u/home/j/jzou1115/project-zarlab/CFW/confidence_interval_pipeline_out/confidence_intervals/EDL.12.83885241.CI.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_interval_pipeline_out/confidence_intervals/EDL.2.155780222.CI.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_interval_pipeline_out/confidence_intervals/EDL.2.77669072.CI.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_interval_pipeline_out/confidence_intervals/TA.12.83514944.CI.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_interval_pipeline_out/confidence_intervals/TA.2.155819633.CI.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_interval_pipeline_out/confidence_intervals/activity.begin.13.8153523.CI.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_interval_pipeline_out/confidence_intervals/activity.end.13.7101524.CI.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_interval_pipeline_out/confidence_intervals/activity.end.13.8209788.CI.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_interval_pipeline_out/confidence_intervals/activity.middle.13.7101524.CI.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_interval_pipeline_out/confidence_intervals/activity.middle.13.8209788.CI.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_interval_pipeline_out/confidence_intervals/activity.middle.13.8800578.CI.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_interval_pipeline_out/confidence_intervals/activity.total.13.7101524.CI.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_interval_pipeline_out/confidence_intervals/activity.total.13.8144012.CI.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_interval_pipeline_out/confidence_intervals/activity.total.13.8800578.CI.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_interval_pipeline_out/confidence_intervals/activity30.13.8139647.CI.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_interval_pipeline_out/confidence_intervals/basal.activity.13.7101524.CI.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_interval_pipeline_out/confidence_intervals/basal.activity.13.8209788.CI.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_interval_pipeline_out/confidence_intervals/bmd.a.11.94758993.CI.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_interval_pipeline_out/confidence_intervals/bmd.a.11.95761488.CI.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_interval_pipeline_out/confidence_intervals/bmd.a.11.96913720.CI.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_interval_pipeline_out/confidence_intervals/bmd.11.94772022.CI.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_interval_pipeline_out/confidence_intervals/bmd.11.95761488.CI.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_interval_pipeline_out/confidence_intervals/bmd.11.96912238.CI.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_interval_pipeline_out/confidence_intervals/bmd.5.21721308.CI.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_interval_pipeline_out/confidence_intervals/bmd.5.23814155.CI.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_interval_pipeline_out/confidence_intervals/bmd.5.24922475.CI.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_interval_pipeline_out/confidence_intervals/bmd.n.11.95582360.CI.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_interval_pipeline_out/confidence_intervals/bmd.n.11.96918212.CI.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_interval_pipeline_out/confidence_intervals/soleus.13.113404971.CI.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_interval_pipeline_out/confidence_intervals/soleus.13.114802392.CI.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_interval_pipeline_out/confidence_intervals/tail.length.8.80905518.CI.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_interval_pipeline_out/confidence_intervals/tail.length.8.81878779.CI.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_interval_pipeline_out/confidence_intervals/tibia.11.96952835.CI.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_interval_pipeline_out/confidence_intervals/tibia.12.83514944.CI.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_interval_pipeline_out/confidence_intervals/tibia.12.91175287.CI.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_interval_pipeline_out/confidence_intervals/tibia.12.91722613.CI.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_interval_pipeline_out/confidence_intervals/tibia.15.11500538.CI.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_interval_pipeline_out/confidence_intervals/tibia.15.12517342.CI.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_interval_pipeline_out/confidence_intervals/tibia.6.147027848.CI.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_interval_pipeline_out/confidence_intervals/tibia.6.147721449.CI.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_interval_pipeline_out/confidence_intervals/tibia.6.148328439.CI.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_interval_pipeline_out/confidence_intervals/tibia.9.81411377.CI.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_interval_pipeline_out/confidence_intervals/tibia.9.83150389.CI.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_interval_pipeline_out/confidence_intervals/tibia.9.85054834.CI.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_interval_pipeline_out/confidence_intervals/weight.bmi.tibia.17.34013675.CI.RData', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_interval_pipeline_out/confidence_intervals/weight.17.34013000.CI.RData'),
    params = list('/u/home/j/jzou1115/project-zarlab/CFW/MegaAnalysis_CFW_2019/genotypes/oxinfo90', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2', '/u/home/j/jzou1115/project-zarlab/CFW/confidence_interval_pipeline_out/confidence_intervals', "g_dir" = '/u/home/j/jzou1115/project-zarlab/CFW/MegaAnalysis_CFW_2019/genotypes/oxinfo90', "mm_dir" = '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2', "ci_out" = '/u/home/j/jzou1115/project-zarlab/CFW/confidence_interval_pipeline_out/confidence_intervals'),
    wildcards = list(),
    threads = 1,
    log = list(),
    resources = list(),
    config = list("outdir" = '/u/home/j/jzou1115/project-zarlab/CFW/confidence_interval_pipeline_out', "mmdir" = '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2', "gdir" = '/u/home/j/jzou1115/project-zarlab/CFW/MegaAnalysis_CFW_2019/genotypes/oxinfo90', "kdir" = '/u/home/j/jzou1115/project-zarlab/CFW/confidence_interval_pipeline_out/grms', "cidir" = '/u/home/j/jzou1115/project-zarlab/CFW/confidence_interval_pipeline_out/confidence_intervals', "scandir" = '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/output2/scans', "chromosomes" = 'data/chromosomes.txt', "phenotypes" = 'data/phenotypes.txt', "qtls" = '/u/home/j/jzou1115/project-zarlab/CFW/confidence_intervals/data/qtls/qtls_decorrelated_threshold2.txt', "qtl_ids" = 'data/qtls_decorrelated_info90.txt'),
    rule = 'simulateConfidenceIntervals',
    bench_iteration = as.numeric(NA),
    scriptdir = '/u/project/zarlab/jzou1115/CFW/MegaAnalysis_CFW_Code/confidence_interval_pipeline/scripts',
    source = function(...){
        wd <- getwd()
        setwd(snakemake@scriptdir)
        source(...)
        setwd(wd)
    }
)


######## Original script #########
library(parallel)
library(graphics)
source("scripts/outbred.pruned.R")
source("scripts/emma.R")

qtlF <- snakemake@input[["qtls"]]
g_dir <- snakemake@params[["g_dir"]]
mm_dir <- snakemake@params[["mm_dir"]]
outdir <- snakemake@params[["ci_out"]]
if(!dir.exists(outdir)){
    mkdir(outdir)
}

setwd(outdir)

print(qtlF)

simulate.confidence.intervals( qtl.file=qtlF, 
                               n.sim=10000, 
                               window=5.0e6, 
                               out.dir=outdir, 
                               per.chromosome=TRUE, 
                               mixed.model=TRUE, 
                               mm.dir=mm_dir, 
                               dir=g_dir, 
                               suffix=".oxinfo90.Rdata" , mc.cores1=1, mc.cores2=1, reverse=FALSE)


#try and redo ones that failed
#tibia	6	145481081	6.34297504628561	0.03125	0.05	144481081	146481081	2000000

#chr = 6
#pheno = "tibia"
#bp = 145481081
#
#qtls = read.table(qtlF, header=T)
#qtls.chr = qtls[qtls$chr==chr,]
#
#
#dosages = load.pruned.allele.dosages.for.chr2( chr=chr, dir=g_dir, suffix=".oxinfo90.dosages.pruned.RData")
#file=paste(outdir, "/", pheno, ".", chr, ".", bp, ".CI.RData", sep="")
#mm.file = paste(mm_dir, "/emma.", pheno, ".RData", sep="")
#load(mm.file)
#mm$per.chromosome = T
#mm$mixed.model = T
#print("starting simulations")
#sim = simulate.qtl.confidence.interval( chr, bp, mm, dosages, n.sim=10000, window=5.0e6, out.dir=outdir, mc.cores=1 )
#print(dim(sim))
#sim.data = list( qtl=qtls.chr[i,], n.sim=n.sim, window=window, sim=sim )
#save(sim.data,file=file)
